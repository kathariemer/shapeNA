---
title: "Graphical_exploration"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Graphical_exploration}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(shapeNA) 
```

For data with missing values, the package provides a few rudimentary tools for graphical 
exploration. Using `R` packages `mvtnorm` and `mice`, we may produce a multivariate normal data set
with missing data. Abusing `graphics::image()`, we can see a plot of cells, were each cell represents a 
matrix entry.

```{r}
set.seed(1)
X <- mvtnorm::rmvnorm(100, numeric(4))
Y <- mice::ampute(X, freq = c(0.15, 0.5, 0.2, 0.05))$amp
image(t(as.matrix(Y)[100:1,]))
```

First, we calculate the Power M-estimator with, e.g., $\alpha = 0$. In order to represent the
shape estimate, it is possible to just `plot` the result. If the estimate resulted from
a data set with missing data, a message about the observed proportion for each variable
is printed in the console.

```{r}
res <- classicShapeNA(Y)
plot(res)
```

The opposite information, i.e. the proportion of missingness, can be represented in form of a barplot:

```{r}
barplotMissProp(res)
```

The pattern of the missingness is saved in the result's `naBlocks` field. When plotting the corresponding object,
the missingness patterns are shown in a concise plot. Each row corresponds to a missingness pattern in the data, 
with blue cells representing observed values for the corresponding variables, and light yellow cells representing
missing values.

The pattern is ordered s.t. the most frequent pattern is in the first row and the least frequent pattern in the bottommost row.
Additionally, to the left of the plot, an approximate proportion of the observed pattern is printed. This might be even clearer, if
the reordered data is shown next to the missingness data:

```{r}
plot(res$naBlocks)
image(t(res$naBlocks$data[100:1,]))
```

We can see, the majority of the data is fully observed. Then, we have a large block of data with missing values for variable `V2`, and in relation, only very few observations with missing data in the other variables.
